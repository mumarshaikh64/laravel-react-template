<div class="app-email card">
    <div class="border-0">
        <div class="row g-0">
            <!-- Email Sidebar -->
            <div class="col app-email-sidebar border-end flex-grow-0" id="app-email-sidebar">
                <div class="btn-compost-wrapper d-grid">
                    <button class="btn btn-primary btn-compose" data-bs-toggle="modal"
                        data-bs-target="#emailComposeSidebar">Compose</button>
                </div>
                <!-- Email Filters -->
                <div class="email-filters pt-4 pb-2">
                    <!-- Email Filters: Folder -->
                    <ul class="email-filter-folders list-unstyled">
                        <li class="active d-flex justify-content-between align-items-center mb-1" data-target="inbox">
                            <a href="javascript:void(0);" class="d-flex flex-wrap align-items-center">
                                <i class="ri-mail-line ri-20px"></i>
                                <span class="align-middle ms-2">Inbox</span>
                            </a>
                            <div class="badge bg-label-primary rounded-pill" id="unread-count">{{ "0" }}</div>
                        </li>
                        <li class="d-flex mb-1" data-target="sent">
                            <a href="javascript:void(0);" class="d-flex flex-wrap align-items-center">
                                <i class="ri-send-plane-line ri-20px"></i>
                                <span class="align-middle ms-2">Sent</span>
                            </a>
                        </li>
                        <!--<li class="d-flex justify-content-between align-items-center mb-1" data-target="draft">-->
                        <!--  <a href="javascript:void(0);" class="d-flex flex-wrap align-items-center">-->
                        <!--    <i class="ri-edit-box-line ri-20px"></i>-->
                        <!--    <span class="align-middle ms-2">Draft</span>-->
                        <!--  </a>-->
                        <!--  <div class="badge bg-label-warning rounded-pill">1</div>-->
                        <!--</li>-->
                        <!--<li class="d-flex justify-content-between mb-1" data-target="starred">-->
                        <!--  <a href="javascript:void(0);" class="d-flex flex-wrap align-items-center">-->
                        <!--    <i class="ri-star-line ri-20px"></i>-->
                        <!--    <span class="align-middle ms-2">Starred</span>-->
                        <!--  </a>-->
                        <!--</li>-->
                        <li class="d-flex justify-content-between align-items-center mb-1" data-target="spam">
                            <a href="javascript:void(0);" class="d-flex flex-wrap align-items-center">
                                <i class="ri-spam-2-line ri-20px"></i>
                                <span class="align-middle ms-2">Spam</span>
                            </a>
                            <div class="badge bg-label-danger rounded-pill"></div>
                        </li>
                        <li class="d-flex align-items-center mb-1" data-target="trash">
                            <a href="javascript:void(0);" class="d-flex flex-wrap align-items-center">
                                <i class="ri-delete-bin-7-line ri-20px"></i>
                                <span class="align-middle ms-2">Trash</span>
                            </a>
                        </li>
                    </ul>
                    <!-- Email Filters: Labels -->
                    <!--<div class="email-filter-labels pt-4">-->
                    <!--  <p class="small mx-5 text-muted text-uppercase">Labels</p>-->
                    <!--  <ul class="list-unstyled mb-2">-->
                    <!--    <li data-target="work">-->
                    <!--      <a href="javascript:void(0);">-->
                    <!--        <i class="badge badge-dot bg-success"></i>-->
                    <!--        <span class="align-middle ms-2">Personal</span>-->
                    <!--      </a>-->
                    <!--    </li>-->
                    <!--    <li data-target="company">-->
                    <!--      <a href="javascript:void(0);">-->
                    <!--        <i class="badge badge-dot bg-primary"></i>-->
                    <!--        <span class="align-middle ms-2">Company</span>-->
                    <!--      </a>-->
                    <!--    </li>-->
                    <!--    <li data-target="important">-->
                    <!--      <a href="javascript:void(0);">-->
                    <!--        <i class="badge badge-dot bg-warning"></i>-->
                    <!--        <span class="align-middle ms-2">Important</span>-->
                    <!--      </a>-->
                    <!--    </li>-->
                    <!--    <li data-target="private">-->
                    <!--      <a href="javascript:void(0);">-->
                    <!--        <i class="badge badge-dot bg-danger"></i>-->
                    <!--        <span class="align-middle ms-2">Private</span>-->
                    <!--      </a>-->
                    <!--    </li>-->
                    <!--  </ul>-->
                    <!--</div>-->
                    <!--/ Email Filters -->
                </div>
            </div>
            <!--/ Email Sidebar -->

            <!-- Emails List -->
            <div class="col app-emails-list">
                <div class="card shadow-none border-0 rounded-0">
                    <div class="card-body emails-list-header p-3 py-2">
                        <!-- Email List: Search -->
                        <div class="d-flex justify-content-between align-items-center px-3 mt-2">
                            <div class="d-flex align-items-center w-100">
                                <i class="ri-menu-line ri-24px cursor-pointer d-block d-lg-none me-4 mb-4"
                                    data-bs-toggle="sidebar" data-target="#app-email-sidebar" data-overlay></i>
                                <div class="mb-4 w-100">
                                    <div class="input-group input-group-merge shadow-none">
                                        <span class="input-group-text border-0 ps-0 py-0" id="email-search">
                                            <i class="ri-search-line ri-22px"></i>
                                        </span>
                                        <input type="text" class="form-control email-search-input border-0 py-0"
                                            placeholder="Search mail" aria-label="Search mail"
                                            aria-describedby="email-search">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <hr class="mx-n3 emails-list-header-hr mb-2">
                        <!-- Email List: Actions -->
                        <div class="d-flex justify-content-between align-items-center ps-1">
                            <div class="d-flex align-items-center">
                                <div class="form-check mb-n1 ms-2">
                                    <input class="form-check-input" type="checkbox" id="email-select-all">
                                    <label class="form-check-label" for="email-select-all"></label>
                                </div>
                                <div class="btn btn-text-secondary btn-icon rounded-pill me-1"><i
                                        class="ri-delete-bin-7-line ri-22px email-list-delete cursor-pointer"></i></div>
                                <div class="btn btn-text-secondary btn-icon rounded-pill me-1"><i
                                        class="ri-mail-open-line ri-22px email-list-read cursor-pointer"></i></div>
                                <!--<div class="dropdown me-1">-->
                                <!--  <button class="btn btn-icon btn-text-secondary rounded-pill p-0" type="button" id="dropdownMenuFolderTwo" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i class="ri-folder-line ri-22px"></i></button>-->
                                <!--  <div class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdownMenuFolderTwo">-->
                                <!--    <a class="dropdown-item" href="javascript:void(0)">-->
                                <!--      <i class="ri-spam-2-line me-1"></i>-->
                                <!--      <span class="align-middle">Spam</span>-->
                                <!--    </a>-->
                                <!--    <a class="dropdown-item" href="javascript:void(0)">-->
                                <!--      <i class="ri-edit-box-line me-1"></i>-->
                                <!--      <span class="align-middle">Draft</span>-->
                                <!--    </a>-->
                                <!--    <a class="dropdown-item" href="javascript:void(0)">-->
                                <!--      <i class="ri-delete-bin-7-line me-1"></i>-->
                                <!--      <span class="align-middle">Trash</span>-->
                                <!--    </a>-->
                                <!--  </div>-->
                                <!--</div>-->
                                <!--<div class="dropdown mx-1">-->
                                <!--  <button class="btn btn-icon btn-text-secondary rounded-pill dropdown-toggle hide-arrow" data-bs-toggle="dropdown" aria-expanded="true" id="dropdownLabelOne"><i class="ri-price-tag-3-line ri-22px"></i></button>-->
                                <!--  <div class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdownLabelOne">-->
                                <!--    <a class="dropdown-item" href="javascript:void(0)">-->
                                <!--      <i class=" badge badge-dot bg-success me-1"></i>-->
                                <!--      <span class="align-middle">Workshop</span>-->
                                <!--    </a>-->
                                <!--    <a class="dropdown-item" href="javascript:void(0)">-->
                                <!--      <i class=" badge badge-dot bg-primary me-1"></i>-->
                                <!--      <span class="align-middle">Company</span>-->
                                <!--    </a>-->
                                <!--    <a class="dropdown-item" href="javascript:void(0)">-->
                                <!--      <i class=" badge badge-dot bg-warning me-1"></i>-->
                                <!--      <span class="align-middle">Important</span>-->
                                <!--    </a>-->
                                <!--    <a class="dropdown-item" href="javascript:void(0)">-->
                                <!--      <i class=" badge badge-dot bg-danger me-1"></i>-->
                                <!--      <span class="align-middle">Private</span>-->
                                <!--    </a>-->
                                <!--  </div>-->
                                <!--</div>-->
                            </div>
                            <div class="d-flex align-items-center">
                                <span class="btn btn-icon btn-text-secondary rounded-pill me-1">
                                    <i class="ri-refresh-line ri-22px scaleX-n1-rtl cursor-pointer email-refresh"></i>
                                </span>
                                <div class="dropdown">
                                    <button class="btn btn-icon btn-text-secondary rounded-pill p-0" type="button"
                                        id="emailsActions" data-bs-toggle="dropdown" aria-haspopup="true"
                                        aria-expanded="false">
                                        <i class="ri-more-2-line ri-22px"></i>
                                    </button>
                                    <div class="dropdown-menu dropdown-menu-end" aria-labelledby="emailsActions">
                                        <a class="dropdown-item" href="javascript:void(0)">Mark as read</a>
                                        <a class="dropdown-item" href="javascript:void(0)">Mark as unread</a>
                                        <a class="dropdown-item" href="javascript:void(0)">Delete</a>
                                        <a class="dropdown-item" href="javascript:void(0)">Archive</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <hr class="container-m-nx m-0">
                    <!-- Email List: Items -->
                    <div class="email-list pt-0">
                        <ul class="list-unstyled m-0">
                            @foreach($emails as $email)
                            <li class="email-list-item {{ $email['isRead'] ? 'email-marked-read' : '' }}"
                                data-email-id="{{ $email['id'] }}" onclick="showEmailDetails('{{ $email['id'] }}')"
                                data-starred="true" data-bs-toggle="sidebar" data-target="#app-email-view">
                                <div class="d-flex align-items-center">
                                    <div class="form-check mb-n1 ms-2">
                                        <input class="email-list-item-input form-check-input" type="checkbox"
                                            id="email-{{ $email['id'] }}">
                                        <label class="form-check-label" for="email-{{ $email['id'] }}"></label>
                                    </div>
                                    <span class="ms-sm-3 me-4">
                                        <i
                                            class="email-list-item-bookmark ri-star-line ri-22px d-sm-inline-block d-none cursor-pointer"></i>
                                    </span>
                                    <img src="{{ asset('assets/img/avatars/1.png') }}" alt="user-avatar"
                                        class="d-block flex-shrink-0 rounded-circle me-sm-2 me-0" height="32"
                                        width="32" />
                                    <div class="email-list-item-content ms-2 ms-sm-0 me-2">
                                        <span class="email-list-item-username me-2 text-heading">
                                            {{ $email['from'] }}
                                        </span>
                                        <span class="email-list-item-subject d-xl-inline-block d-block">
                                            {{ $email['subject'] }}
                                        </span>
                                    </div>
                                    <div class="email-list-item-meta ms-auto d-flex align-items-center">
                                        <small class="email-list-item-time text-muted"></small>
                                        <ul class="list-inline email-list-item-actions">
                                            <li
                                                class="list-inline-item email-delete btn btn-icon btn-text-secondary rounded-pill">
                                                <i class='ri-delete-bin-7-line ri-22px'></i>
                                            </li>
                                            <li
                                                class="list-inline-item email-read btn btn-icon btn-text-secondary rounded-pill">
                                                @if($email['isRead'])
                                                <i class='ri-mail-open-line ri-22px'></i>
                                                @else
                                                <i class='ri-mail-line ri-22px'></i>
                                                @endif

                                                <!--<i class='ri-mail-open-line ri-22px'></i> -->
                                            </li>
                                            <li class="list-inline-item btn btn-icon btn-text-secondary rounded-pill">
                                                <i class='ri-information-line ri-22px'></i>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </li>
                            @endforeach
                            @foreach($sentEmails as $sentEmail)
                            <li class="email-list-item email-marked-read" data-email-id="{{ $sentEmail['id'] }}"
                                onclick="showEmailDetails('{{ $sentEmail['id'] }}')" data-sent="true"
                                data-bs-toggle="sidebar" data-target="#app-email-view">
                                <div class="d-flex align-items-center">
                                    <div class="form-check mb-n1 ms-2">
                                        <input class="email-list-item-input form-check-input" type="checkbox"
                                            id="email-{{ $sentEmail['id'] }}">
                                        <label class="form-check-label" for="email-{{ $sentEmail['id'] }}"></label>
                                    </div>
                                    <span class="ms-sm-3 me-4">
                                        <i
                                            class="email-list-item-bookmark ri-star-line ri-22px d-sm-inline-block d-none cursor-pointer ms-1"></i>
                                    </span>
                                    <img src="{{ asset('assets/img/avatars/2.png') }}" alt="user-avatar"
                                        class="d-block flex-shrink-0 rounded-circle me-sm-2 me-0" height="32"
                                        width="32" />
                                    <div class="email-list-item-content ms-2 ms-sm-0 me-2">
                                        <span class="email-list-item-username me-2 h6">
                                        </span>
                                        <span class="email-list-item-subject d-xl-inline-block d-block">
                                            {{ $sentEmail['subject'] }}
                                        </span>
                                    </div>
                                    <div class="email-list-item-meta ms-auto d-flex align-items-center">
                                        <span
                                            class="email-list-item-label badge badge-dot bg-primary d-none d-md-inline-block me-2"
                                            data-label="important"></span>
                                        <span
                                            class="email-list-item-label badge badge-dot bg-danger d-none d-md-inline-block me-2"
                                            data-label="private"></span>
                                        <small class="email-list-item-time text-muted"></small>
                                        <ul class="list-inline email-list-item-actions">
                                            <li
                                                class="list-inline-item email-delete btn btn-icon btn-text-secondary rounded-pill">
                                                <i class='ri-delete-bin-7-line ri-22px'></i>
                                            </li>
                                            <li
                                                class="list-inline-item email-unread btn btn-icon btn-text-secondary rounded-pill">
                                                <i class='ri-mail-line ri-22px'></i>
                                            </li>
                                            <li class="list-inline-item btn btn-icon btn-text-secondary rounded-pill">
                                                <i class='ri-information-line ri-22px'></i>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </li>
                            @endforeach


                            <li class="email-list-item email-marked-read" data-spam="true" data-bs-toggle="sidebar"
                                data-target="#app-email-view">
                                <div class="d-flex align-items-center">
                                    <div class="form-check mb-n1 ms-2">
                                        <input class="email-list-item-input form-check-input" type="checkbox"
                                            id="email-5">
                                        <label class="form-check-label" for="email-5"></label>
                                    </div>
                                    <span class="ms-sm-3 me-4"><i
                                            class="email-list-item-bookmark ri-star-line ri-22px d-sm-inline-block d-none cursor-pointer ms-1"></i></span>
                                    <img src="{{ asset('assets/img/avatars/4.png')}}" alt="user-avatar"
                                        class="d-block flex-shrink-0 rounded-circle me-sm-2 me-0" height="32"
                                        width="32" />
                                    <div class="email-list-item-content ms-2 ms-sm-0 me-2">
                                        <span class="email-list-item-username me-2 h6">Ted Mosby</span>
                                        <span class="email-list-item-subject d-xl-inline-block d-block"> Hey Katy, I
                                            love Pudding cookie chocolate sweet tiramisu jujubes I love danish.</span>
                                    </div>
                                    <div class="email-list-item-meta ms-auto d-flex align-items-center">
                                        <span
                                            class="email-list-item-label ribadge badge-dot bg-danger d-none d-md-inline-block me-2"
                                            data-label="company"></span>
                                        <small class="email-list-item-time text-muted">Yesterday</small>
                                        <ul class="list-inline email-list-item-actions">
                                            <li
                                                class="list-inline-item email-delete btn btn-icon btn-text-secondary rounded-pill">
                                                <i class='ri-delete-bin-7-line ri-22px'></i>
                                            </li>
                                            <li
                                                class="list-inline-item email-unread btn btn-icon btn-text-secondary rounded-pill">
                                                <i class='ri-mail-line ri-22px'></i>
                                            </li>
                                            <li class="list-inline-item btn btn-icon btn-text-secondary rounded-pill">
                                                <i class='ri-information-line ri-22px'></i>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </li>

                            @foreach($spamEmails as $spamEmail)
                            <li class="email-list-item email-marked-read" data-email-id="{{ $spamEmail['id'] }}"
                                onclick="showEmailDetails('{{ $spamEmail['id'] }}')" data-spam="true"
                                data-bs-toggle="sidebar" data-target="#app-email-view">
                                <div class="d-flex align-items-center">
                                    <div class="form-check mb-n1 ms-2">
                                        <input class="email-list-item-input form-check-input" type="checkbox"
                                            id="email-{{ $spamEmail['id'] }}">
                                        <label class="form-check-label" for="email-{{ $spamEmail['id'] }}"></label>
                                    </div>
                                    <span class="ms-sm-3 me-4">
                                        <i
                                            class="email-list-item-bookmark ri-star-line ri-22px d-sm-inline-block d-none cursor-pointer ms-1"></i>
                                    </span>
                                    <img src="{{ asset('assets/img/avatars/4.png') }}" alt="user-avatar"
                                        class="d-block flex-shrink-0 rounded-circle me-sm-2 me-0" height="32"
                                        width="32" />
                                    <div class="email-list-item-content ms-2 ms-sm-0 me-2">
                                        <span class="email-list-item-username me-2 h6">
                                            {{ $spamEmail['from'] }}
                                        </span>
                                        <span class="email-list-item-subject d-xl-inline-block d-block">
                                            {{ $spamEmail['subject'] }}
                                        </span>
                                    </div>
                                    <div class="email-list-item-meta ms-auto d-flex align-items-center">
                                        <span
                                            class="email-list-item-label badge badge-dot bg-danger d-none d-md-inline-block me-2"
                                            data-label="company"></span>
                                        <small class="email-list-item-time text-muted"></small>
                                        <ul class="list-inline email-list-item-actions">
                                            <li
                                                class="list-inline-item email-delete btn btn-icon btn-text-secondary rounded-pill">
                                                <i class='ri-delete-bin-7-line ri-22px'></i>
                                            </li>
                                            <li
                                                class="list-inline-item email-unread btn btn-icon btn-text-secondary rounded-pill">
                                                <i class='ri-mail-line ri-22px'></i>
                                            </li>
                                            <li class="list-inline-item btn btn-icon btn-text-secondary rounded-pill">
                                                <i class='ri-information-line ri-22px'></i>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </li>
                            @endforeach
                            @foreach($trashEmails as $trashEmail)
                            <li class="email-list-item" data-trash="true" data-email-id="{{ $trashEmail['id'] }}"
                                onclick="showEmailDetails('{{ $trashEmail['id'] }}')" data-bs-toggle="sidebar"
                                data-target="#app-email-view">
                                <div class="d-flex align-items-center">
                                    <div class="form-check mb-n1 ms-2">
                                        <input class="email-list-item-input form-check-input" type="checkbox"
                                            id="email-{{ $trashEmail['id'] }}">
                                        <label class="form-check-label" for="email-{{ $trashEmail['id'] }}"></label>
                                    </div>
                                    <span class="ms-sm-3 me-4">
                                        <i
                                            class="email-list-item-bookmark ri-star-line ri-22px d-sm-inline-block d-none cursor-pointer ms-1"></i>
                                    </span>
                                    <div class="avatar avatar-sm d-block flex-shrink-0 me-sm-4 me-0">
                                        <span class="avatar-initial rounded-circle bg-label-info">{{
                                            strtoupper(substr($trashEmail['from'], 0, 2)) }}</span>
                                    </div>
                                    <div class="email-list-item-content ms-2 ms-sm-0 me-2">
                                        <span class="email-list-item-username me-2 h6">
                                            {{ $trashEmail['from'] }}
                                        </span>
                                        <span class="email-list-item-subject d-xl-inline-block d-block">
                                            {{ $trashEmail['subject'] }}
                                        </span>
                                    </div>
                                    <div class="email-list-item-meta ms-auto d-flex align-items-center">
                                        <span
                                            class="email-list-item-label badge badge-dot bg-primary d-none d-md-inline-block me-2"
                                            data-label="work"></span>
                                        <small class="email-list-item-time text-muted"></small>
                                        <ul class="list-inline email-list-item-actions">
                                            <li
                                                class="list-inline-item email-delete btn btn-icon btn-text-secondary rounded-pill">
                                                <i class='ri-delete-bin-7-line ri-22px'></i>
                                            </li>
                                            <li
                                                class="list-inline-item email-read btn btn-icon btn-text-secondary rounded-pill">
                                                <i class='ri-mail-open-line ri-22px'></i>
                                            </li>
                                            <li class="list-inline-item btn btn-icon btn-text-secondary rounded-pill">
                                                <i class='ri-information-line ri-22px'></i>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </li>
                            @endforeach






                        </ul>
                        <ul class="list-unstyled m-0">
                            <li class="email-list-empty text-center d-none">No items found.</li>
                        </ul>
                    </div>
                </div>
                <div class="app-overlay"></div>
            </div>
            <!-- /Emails List -->

            <!-- Email View -->
            <div class="col app-email-view flex-grow-0 bg-lighter" id="app-email-view">
                <div class="card-body app-email-view-header p-5 pt-md-4 py-2">
                    <!-- Email View : Title  bar-->
                    <div class="d-flex justify-content-between align-items-center">
                        <div class="d-flex align-items-center overflow-hidden">
                            <span class="ms-sm-2 me-4"><i class="ri-arrow-left-s-line ri-22px cursor-pointer"
                                    data-bs-toggle="sidebar" data-target="#app-email-view"></i></span>
                            <h6 class="text-truncate mb-0 me-2 fw-normal" id="subjectMail">Focused impactful open issues
                            </h6>
                            <!--<span class="badge bg-label-warning rounded-pill">Important</span>-->
                        </div>
                        <!-- Email View : Action bar-->
                        <!--<div class="d-flex align-items-center">-->
                        <!--  <span class="btn btn-icon p-0 me-2 text-muted">-->
                        <!--    <i class='ri-arrow-left-s-line ri-22px'></i>-->
                        <!--  </span>-->
                        <!--  <span class="btn btn-icon p-0">-->
                        <!--    <i class="ri-arrow-right-s-line ri-22px"></i>-->
                        <!--  </span>-->
                        <!--</div>-->
                    </div>
                    <hr class="app-email-view-hr mx-n5 mb-2">
                    <div class="d-flex justify-content-between align-items-center">
                        <div class="d-flex align-items-center">
                            <span class="btn btn-icon btn-text-secondary rounded-pill me-1"><i
                                    class='ri-delete-bin-7-line ri-22px cursor-pointer'></i></span>
                            <!--<span class="btn btn-icon btn-text-secondary rounded-pill me-1"><i class='ri-mail-line ri-22px cursor-pointer' data-bs-toggle="sidebar" data-target="#app-email-view"></i></span>-->
                            <!--<div class="dropdown">-->
                            <!--  <button class="btn btn-icon btn-text-secondary rounded-pill p-0 me-1" type="button" id="dropdownMenuFolderOne" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">-->
                            <!--    <i class="ri-folder-line ri-22px"></i>-->
                            <!--  </button>-->
                            <!--  <div class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdownMenuFolderOne">-->
                            <!--    <a class="dropdown-item" href="javascript:void(0)">-->
                            <!--      <i class="ri-spam-2-line me-1"></i>-->
                            <!--      <span class="align-middle">Spam</span>-->
                            <!--    </a>-->
                            <!--    <a class="dropdown-item" href="javascript:void(0)">-->
                            <!--      <i class="ri-edit-box-line me-1"></i>-->
                            <!--      <span class="align-middle">Draft</span>-->
                            <!--    </a>-->
                            <!--    <a class="dropdown-item" href="javascript:void(0)">-->
                            <!--      <i class="ri-mail-line me-1"></i>-->
                            <!--      <span class="align-middle">Trash</span>-->
                            <!--    </a>-->
                            <!--  </div>-->
                            <!--</div>-->
                            <!--<div class="dropdown">-->
                            <!--  <button class="btn btn-icon btn-text-secondary rounded-pill p-0" type="button" id="dropdownLabelTwo" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">-->
                            <!--    <i class="ri-price-tag-3-line ri-22px"></i>-->
                            <!--  </button>-->
                            <!--  <div class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdownLabelTwo">-->
                            <!--    <a class="dropdown-item" href="javascript:void(0)">-->
                            <!--      <i class="badge badge-dot bg-success me-1"></i>-->
                            <!--      <span class="align-middle">Workshop</span>-->
                            <!--    </a>-->
                            <!--    <a class="dropdown-item" href="javascript:void(0)">-->
                            <!--      <i class="badge badge-dot bg-primary me-1"></i>-->
                            <!--      <span class="align-middle">Company</span>-->
                            <!--    </a>-->
                            <!--    <a class="dropdown-item" href="javascript:void(0)">-->
                            <!--      <i class="badge badge-dot bg-info me-1"></i>-->
                            <!--      <span class="align-middle">Important</span>-->
                            <!--    </a>-->
                            <!--  </div>-->
                            <!--</div>-->
                        </div>
                        <!--<div class="d-flex align-items-center">-->
                        <!--  <span class="btn btn-icon btn-text-secondary rounded-pill p-0">-->
                        <!--    <i class='ri-star-line ri-22px'></i>-->
                        <!--  </span>-->
                        <!--  <div class="dropdown ms-1">-->
                        <!--    <button class="btn btn-icon btn-text-secondary rounded-pill p-0" type="button" id="dropdownMoreOptions" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">-->
                        <!--      <i class="ri-more-2-line ri-22px"></i>-->
                        <!--    </button>-->
                        <!--    <div class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdownMoreOptions">-->
                        <!--      <a class="dropdown-item" href="javascript:void(0)">-->
                        <!--        <i class="ri-mail-line me-1"></i>-->
                        <!--        <span class="align-middle">Mark as unread</span>-->
                        <!--      </a>-->
                        <!--      <a class="dropdown-item" href="javascript:void(0)">-->
                        <!--        <i class="ri-mail-open-line me-1"></i>-->
                        <!--        <span class="align-middle">Mark as read</span>-->
                        <!--      </a>-->
                        <!--      <a class="dropdown-item" href="javascript:void(0)">-->
                        <!--        <i class="ri-star-line me-1"></i>-->
                        <!--        <span class="align-middle">Add star</span>-->
                        <!--      </a>-->
                        <!--      <a class="dropdown-item" href="javascript:void(0)">-->
                        <!--        <i class="ri-calendar-2-line me-1"></i>-->
                        <!--        <span class="align-middle">Create Event</span>-->
                        <!--      </a>-->
                        <!--      <a class="dropdown-item" href="javascript:void(0)">-->
                        <!--        <i class="ri-volume-mute-line me-1"></i>-->
                        <!--        <span class="align-middle">Mute</span>-->
                        <!--      </a>-->
                        <!--      <a class="dropdown-item d-sm-none d-block" href="javascript:void(0)">-->
                        <!--        <i class="ri-printer-line me-1"></i>-->
                        <!--        <span class="align-middle">Print</span>-->
                        <!--      </a>-->
                        <!--    </div>-->
                        <!--  </div>-->
                        <!--</div>-->
                    </div>
                </div>
                <hr class="m-0">
                <!-- Email View : Content-->
                <div class="app-email-view-content py-4">
                    <!-- Email View : Single Email Card -->
                    <div class="card email-card mx-sm-6 mx-3">
                        <div
                            class="card-header d-flex justify-content-between align-items-center flex-wrap border-bottom">
                            <div class="d-flex align-items-center mb-sm-0 mb-3">
                                <img src="{{ asset('assets/img/avatars/2.png')}}" alt="user-avatar"
                                    class="flex-shrink-0 rounded-circle me-4" height="38" width="38" />
                                <div class="flex-grow-1 ms-1">
                                    <h6 class="m-0 fw-normal" id="email-from-name"> <!-- Name will go here --></h6>
                                    <small class="text-body" id="email-from-address">
                                        <!-- Email Address will go here --></small>
                                </div>
                            </div>
                            <div class="d-flex align-items-center">
                                <p class="mb-0 me-4 text-muted" id="email-date"> <!-- Date will go here --></p>
                                <!--<span class="btn btn-icon btn-text-secondary rounded-pill"><i class="ri-attachment-2 ri-22px cursor-pointer"></i></span>-->
                                <!--<span class="btn btn-icon btn-text-secondary rounded-pill"><i class="email-list-item-bookmark ri-star-line ri-22px cursor-pointer"></i></span>-->
                                <!--<div class="dropdown">-->
                                <!--    <button class="btn btn-icon btn-text-secondary rounded-pill p-0" type="button" id="dropdownEmailOne" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">-->
                                <!--        <i class="ri-more-2-line ri-22px"></i>-->
                                <!--    </button>-->
                                <!--    <div class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdownEmailOne">-->
                                <!--        <a class="dropdown-item scroll-to-reply" href="javascript:void(0)">-->
                                <!--            <i class="ri-reply-line me-1"></i>-->
                                <!--            <span class="align-middle">Reply</span>-->
                                <!--        </a>-->
                                <!--        <a class="dropdown-item" href="javascript:void(0)">-->
                                <!--            <i class="ri-share-forward-line me-1"></i>-->
                                <!--            <span class="align-middle">Forward</span>-->
                                <!--        </a>-->
                                <!--        <a class="dropdown-item" href="javascript:void(0)">-->
                                <!--            <i class="ri-spam-2-line me-1"></i>-->
                                <!--            <span class="align-middle">Report</span>-->
                                <!--        </a>-->
                                <!--    </div>-->
                                <!--</div>-->
                            </div>
                        </div>

                        <div class="card-body pt-5">

                            <p id="email-from"> <!-- From will go here --></p>
                            <p id="email-body"> <!-- Body content will go here --></p>

                            <div id="replies-container"></div>

                            <!--<p class="mb-0">Sincerely yours,</p>-->
                            <!--<p class="fw-medium mb-0">Envato Design Team</p>-->
                            <hr>
                        </div>
                    </div>

                    <!-- Email View : Reply Section -->
                    <div class="email-reply card mt-4 mx-sm-6 mx-3 mb-4">
                        <div class="card-body pt-0 ps-3">
                            <form id="replyForm">
                                <input type="hidden" id="replyTo" name="replyTo" value="">
                                <input type="hidden" id="replySubject" name="replySubject" value="">
                                <textarea id="replyMessage" name="replyMessage" class="form-control mb-3" rows="5"
                                    placeholder="Type your reply here..."></textarea>
                                <div class="d-flex justify-content-end align-items-center mt-4">
                                    <button type="button" id="sendReplyBtn" class="btn btn-primary">
                                        <span class="align-middle">Send</span>
                                        <i class="ri-send-plane-line ri-16px ms-2"></i>
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Email View -->
        </div>
    </div>

    <!-- Compose Email -->
    <div class="app-email-compose modal" id="emailComposeSidebar" tabindex="-1" aria-labelledby="emailComposeSidebar"
        aria-hidden="true">
        <div class="modal-dialog m-0 me-md-6 mb-6 modal-lg">
            <div class="modal-content p-0">
                <div class="modal-header py-5 justify-content-between">
                    <h5 class="modal-title text-body fs-5">Compose Mail</h5>
                    <div class="d-flex align-items-center gap-2">
                        <span class="btn btn-sm btn-icon btn-text-secondary"><i
                                class='ri-subtract-line ri-20px'></i></span>
                        <button type="button" class="btn-close me-2" data-bs-dismiss="modal"
                            aria-label="Close"></button>
                    </div>
                </div>
                <div class="modal-body flex-grow-1 pb-sm-0 p-5 py-2">
                    <form action="{{ route('composeEmail') }}" method="POST" class="email-compose-form">
                        @csrf
                        <div class="email-compose-to d-flex justify-content-between align-items-center">
                            <label class="fw-medium mb-1 text-muted" for="to_email">To:</label>
                            <input type="email" class="form-control border-0 shadow-none flex-grow-1 mx-2" id="to_email"
                                name="to_email" placeholder="Enter recipient's email" required>
                        </div>

                        <hr class="mx-n5 my-0">

                        <div class="email-compose-subject d-flex align-items-center">
                            <label for="email-subject" class="fw-medium text-muted">Subject:</label>
                            <input type="text" class="form-control border-0 shadow-none flex-grow-1 mx-2"
                                id="email-subject" name="subject" required>
                        </div>
                        <div class="email-compose-subject d-flex align-items-center">
                            <label for="email-subject" class="fw-medium text-muted">Message:</label>
                            <input type="text" class="form-control border-0 shadow-none flex-grow-1 mx-2"
                                id="email-subject" name="message" required>
                        </div>


                        <hr class="mx-n5 mt-0 mb-2">

                        <div class="email-compose-actions d-flex justify-content-between align-items-center my-4">
                            <button type="submit" class="btn btn-primary">Send</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script>
    $(document).ready(function () {
        // Event listener for email clicks
        $(document).on('click', '.email-list-item', function () {
            var emailId = $(this).data('email-id'); // Get email ID from data attribute
            showEmailDetails(emailId); // Call the function with the email ID
        });
    });
    function showEmailDetails(emailId) {
        // Fetch the email details using AJAX
        $.ajax({
            url: `/emails/${emailId}`, // Assuming this is the correct route
            type: 'GET',
            dataType: 'json',
            success: function (data) {
                if (data.error) {
                    alert(data.error);
                    return;
                }
                console.log(data);
                // Update the email content in the card
                $('#email-subject').text(data.subject || 'No Subject');
                $("#subjectMail").text("Subject " + data.subject || 'No Subject');
                $("#email-from-name").text(data.from?.name || 'Unknown Sender');
                $("#email-from-address").text(data.from?.mail || 'Unknown Sender');
                $('#email-from').text('From: ' + (data.from?.mail || 'Unknown Sender'));

                $('#email-body').html(data.body || 'No content available');

                // Populate hidden fields for the reply form
                $('#replyTo').val(data.from['mail']); // Set the 'replyTo' value
                $('#replySubject').val('Re: ' + (data.subject || 'No Subject')); // Set the 'replySubject' value





                var repliesHtml = '';
                data.replies.forEach(function (reply) {
                    repliesHtml += '<div class="reply">';
                    // repliesHtml += '<h5>' + reply.subject + '</h5>';
                    repliesHtml += '<p><strong>From:</strong> ' + reply.from['mail'] + '</p>';
                    repliesHtml += '<div>' + reply.body + '</div>';
                    repliesHtml += '</div>';
                });

                console.log(data.replies)
                $('#replies-container').html(repliesHtml);
            },
            error: function (xhr, status, error) {
                console.error('Error fetching email details:', error);
                alert('Failed to fetch email details.');
            }
        });
    }


    $(document).on('click', '.email-delete', function () {
        var emailId = $(this).data('id'); // Get the email ID from the data-id attribute

        if (confirm('Are you sure you want to delete this email from trash?')) {
            $.ajax({
                url: '/delete-from-trash/' + emailId, // API endpoint to handle deletion
                method: 'DELETE',
                success: function (response) {
                    $('#email-item-' + emailId).remove();
                    alert(response.message);
                },
                error: function (error) {
                    alert('Error deleting email.');
                }
            });
        }
    });


</script>
@endsection
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script>


    $(document).on('click', '.email-delete', function () {
        var emailId = $(this).data('id'); // Get the email ID from the data-id attribute

        if (confirm('Are you sure you want to delete this email from trash?')) {
            $.ajax({
                url: '/delete-from-trash/' + emailId, // API endpoint to handle deletion
                method: 'DELETE',
                success: function (response) {
                    $('#email-item-' + emailId).remove();
                    alert(response.message); // Show success message
                },
                error: function (error) {
                    alert('Error deleting email.');
                }
            });
        }
    });
    $(document).ready(function () {
        $('#sendReplyBtn').on('click', function () {
            var replyTo = $('#replyTo').val();
            var replySubject = $('#replySubject').val();

            var replyMessage = $('#replyMessage').val();

            // console.log(replySubject);
            // return;
            // Validate the input fields
            if (!replyTo || !replySubject || !replyMessage) {
                alert('All fields are required.');
                return;
            }

            // Send the reply via AJAX
            $.ajax({
                url: '/emails/reply',
                type: 'POST',
                dataType: 'json',
                data: {
                    replyTo: replyTo,
                    replySubject: replySubject,
                    replyMessage: replyMessage,
                    _token: $('meta[name="csrf-token"]').attr('content'), // Include CSRF token
                },
                success: function (response) {
                    alert(response.message);
                    $('#replyMessage').val(''); // Clear the message field on success
                },
                error: function (xhr, status, error) {
                    console.error('Error sending reply:', xhr.responseJSON.message);
                    alert('Failed to send reply.');
                },
            });
        });
    });

    $(document).ready(function () {
        // When an email item is clicked
        $('.email-list-item').on('click', function () {
            var emailId = $(this).data('email-id');

            // Update the unread count in the UI
            var unreadCount = parseInt($('#unread-count').text());
            if (unreadCount > 0) {
                $('#unread-count').text(unreadCount - 1); // Decrease unread count
            }

            // Send AJAX request to mark the email as read
            $.ajax({
                url: '/mark-email-read/' + emailId, // Update this URL to your endpoint
                method: 'POST',
                data: {
                    _token: $('meta[name="csrf-token"]').attr('content') // CSRF token
                },
                success: function (response) {
                    // If you want, you can handle success here
                    console.log('Email marked as read');
                },
                error: function (error) {
                    console.error('Error marking email as read', error);
                }
            });
        });
    });


</script>